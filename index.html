<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Representation Stability for Varieties</title>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root {
      --bg-color: #f7f7f7;
      --text-color: #333;
      --input-bg: #f0f0f0;
      --border-color: #bbb;
      --equation-bg: #eee;
      --error-color: #b00020;
    }
    body.dark {
      --bg-color: #1e1e1e;
      --text-color: #e5e5e5;
      --input-bg: #2c2c2c;
      --border-color: #555;
      --equation-bg: #2a2a2a;
      --error-color: #ff6b6b;
    }
    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.6;
      transition: background-color 0.3s, color 0.3s;
    }
    .container { max-width: 800px; margin: 0 auto; padding: 2rem; }
    header { text-align: center; margin-bottom: 2rem; position: relative; }
    header h1 { font-size: 2.2rem; margin: 0.5rem 0; }
    #themeToggle {
      position: absolute; top: 0; right: 0; margin: 1rem;
      padding: 0.4rem 0.8rem; border: none; border-radius: 6px;
      background: var(--input-bg); color: var(--text-color);
      cursor: pointer; font-size: 0.9rem;
    }
    #themeToggle:hover { background: var(--border-color); }
    h3 { margin-top: 2rem; font-size: 1.4rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.3rem; }
    label { display: block; margin: 1rem 0 0.5rem; font-weight: 500; }
    .select-wrapper { position: relative; display: inline-block; width: 100%; max-width: 300px; }
    .select-wrapper select {
      -webkit-appearance: none; -moz-appearance: none; appearance: none;
      background-color: var(--input-bg); border: 1px solid var(--border-color);
      border-radius: 6px; padding: 0.5rem 2rem 0.5rem 0.75rem; font-size: 1rem;
      color: var(--text-color); cursor: pointer; outline: none; box-shadow: none; width: 100%;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    .select-wrapper::after { content: "▾"; position: absolute; top: 50%; right: 0.75rem; transform: translateY(-50%); color: var(--text-color); pointer-events: none; }
    input {
      padding: 0.5rem; font-size: 1rem; border: 1px solid var(--border-color);
      border-radius: 6px; width: 100%; max-width: 300px;
      background-color: var(--input-bg); color: var(--text-color);
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    button {
      margin-top: 1.5rem; padding: 0.6rem 1.2rem; font-size: 1rem;
      border: none; border-radius: 6px; background: #444; color: #fff; cursor: pointer;
    }
    button:hover { background: #222; }
    .equation {
      margin-top: 1.5rem;
      padding: 1rem;
      background: var(--equation-bg);
      border-left: 3px solid var(--border-color);
      min-height: 2rem;

      white-space: nowrap;    
      overflow-x: auto;       
      overflow-y: hidden;
      max-width: 100%;        
      box-sizing: border-box;
    }

    .error { color: var(--error-color); font-weight: 600; margin-top: 1rem; }
  </style>
</head>
<body>

  <!-- ============================================
     Drop-Down Explanation Section
     ============================================ -->
<style>
  .dropdown {
    margin-top: 2rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--input-bg);
    transition: background-color 0.3s, border-color 0.3s;
  }

  .dropdown-header {
    padding: 0.75rem 1rem;
    cursor: pointer;
    user-select: none;
    font-weight: 600;
    color: var(--text-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .dropdown-header:hover {
    background: var(--border-color);
  }

  .dropdown-arrow {
    transition: transform 0.3s ease;
  }

  .dropdown-content {
    max-height: 0;
    overflow: hidden;
    padding: 0 1rem;
    background: var(--bg-color);
    color: var(--text-color);
    transition: max-height 0.5s ease, padding 0.3s ease;
  }

  .dropdown.open .dropdown-content {
    padding: 1rem;
  }

  .dropdown.open .dropdown-arrow {
    transform: rotate(90deg);
  }
</style>

<div class="dropdown" id="explanationBox">
  <div class="dropdown-header">
    <span>Additional Explanation</span>
    <span class="dropdown-arrow">▸</span>
  </div>
  <div class="dropdown-content">
    <p>
      This section can contain any additional comments, computations,
      or mathematical explanation you want to provide. It will smoothly
      expand and collapse when clicked, and the styling adapts to both
      light and dark modes.
    </p>
    <p>
      You can freely include MathJax expressions such as
      \( H^i(X, \mathbb{Q}_\ell) \), \( \mathcal{F} \),
      or representation-theoretic notation.  
      MathJax will automatically typeset them when visible.
    </p>
  </div>
</div>

<script>
  const dd = document.getElementById("explanationBox");
  const header = dd.querySelector(".dropdown-header");
  const content = dd.querySelector(".dropdown-content");

  header.addEventListener("click", () => {
    dd.classList.toggle("open");

    if (dd.classList.contains("open")) {
      // expand smoothly
      content.style.maxHeight = content.scrollHeight + "px";
    } else {
      // collapse smoothly
      content.style.maxHeight = "0";
    }
  });
</script>

  
  <div class="container">
    <header>
      <h1>Representation Stability for Varieties</h1>
      <button id="themeToggle">Dark</button>
    </header>

    <section>
      <h3>Choose Options</h3>

      <label for="curveSelect">Select an algebraic variety:</label>
      <div class="select-wrapper">
        <select id="curveSelect">
          <option value="">-- Select Variety --</option>
          <option value="A1">Affine line \( \mathbb{A}^1 \)</option>
          <option value="P1">Projective line \( \mathbb{P}^1 \)</option>
          <option value="P2">Projective 2-space \( \mathbb{P}^2 \)</option>
          <option value="P3">Projective 3-space \( \mathbb{P}^3 \)</option>
          <option value="P4">Projective 4-space \( \mathbb{P}^4 \)</option>
          <option value="P5">Projective 5-space \( \mathbb{P}^5 \)</option>
          <option value="E">Elliptic curve \( E \)</option>
        </select>
      </div>

      <label for="outputSelect">Select an output type:</label>
      <div class="select-wrapper">
        <select id="outputSelect">
          <option value="">-- Select Output --</option>
          <option value="rational">Rational function</option>
          <option value="laurent">Laurent series</option>
          <!-- <option value="multiplicities">Multiplicities</option> -->
        </select>
      </div>

      <label for="partitionInput">Enter a partition of \( n \leq 5 \) (e.g. "3,2,1"):</label>
      <input type="text" id="partitionInput" placeholder="e.g. 3,2,1">

      <button id="submitBtn">Compute</button>

      <div id="errorMsg" class="error"></div>
      <div id="equationBox" class="equation">
        The computations will appear here.
      </div>
    </section>
  </div>

  <script>
    const submitBtn = document.getElementById("submitBtn");
    const equationBox = document.getElementById("equationBox");
    const errorMsg = document.getElementById("errorMsg");
    const themeToggle = document.getElementById("themeToggle");

    function isValidPartition(input) {
      if (!input) return false;
      const parts = input.split(",").map(s => s.trim());
      if (!parts.every(p => /^\d+$/.test(p))) return false;
      const nums = parts.map(Number);
      const sum = nums.reduce((a, b) => a + b, 0);
      return sum <= 5;
    }

    async function loadExpression(curve, output, partition) {
      try {
        const url = `data/${curve}/${output}.json`;
        const response = await fetch(url);
        if (!response.ok) throw new Error("File not found");
        const data = await response.json();
        return data[partition] || null;
      } catch (err) {
        console.error(err);
        return null;
      }
    }

    submitBtn.addEventListener("click", async () => {
      errorMsg.textContent = "";
      equationBox.textContent = "Processing...";

      const curve = document.getElementById("curveSelect").value;
      const output = document.getElementById("outputSelect").value;
      const partition = document.getElementById("partitionInput").value.trim();

      if (!curve || !output) {
        errorMsg.textContent = "Please select both a variety and an output type.";
        equationBox.textContent = "";
        return;
      }

      if (!isValidPartition(partition)) {
        errorMsg.textContent = "Invalid partition. Enter a partition of n with n ≤ 5 (e.g. '3,2,1').";
        equationBox.textContent = "";
        return;
      }

      const expr = await loadExpression(curve, output, partition);
      if (expr) {
        equationBox.innerHTML = expr;
        MathJax.typesetPromise([equationBox]);
      } else {
        equationBox.textContent = "Information has not yet been added for this representation.";
      }
    });

    themeToggle.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      themeToggle.textContent =
        document.body.classList.contains("dark") ? "Light" : "Dark";
    });
  </script>
</body>
</html>
